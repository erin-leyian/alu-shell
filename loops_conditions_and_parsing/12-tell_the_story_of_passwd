#!/usr/bin/env bash
# This script creates a story for each /etc/passwd entry using a message template

START=1
END=$(wc -l < /etc/passwd)
> story.txt  # Clear the output file

while [ $START -le "$END" ]; do
  LINE=$(head -n "$START" /etc/passwd | tail -n 1)
  
  # Extract fields
  USERNAME=$(echo "$LINE" | awk -F: '{print $1}')
  PASSWORD=$(echo "$LINE" | awk -F: '{print $2}')
  USER_ID=$(echo "$LINE" | awk -F: '{print $3}')
  GROUP_ID=$(echo "$LINE" | awk -F: '{print $4}')
  HOME_DIRECTORY=$(echo "$LINE" | awk -F: '{print $6}')
  SHELL=$(echo "$LINE" | awk -F: '{print $7}')

  # Replace placeholders in message.txt
  sed "s#USERNAME#$USERNAME#g; \
       s#PASSWORD#$PASSWORD#g; \
       s#USER ID#$USER_ID#g; \
       s#GROUP_ID#$GROUP_ID#g; \
       s#HOME_DIRECTORY#$HOME_DIRECTORY#g; \
       s#COMMAND/SHELL#$SHELL#g" message.txt >> story.txt

  ((START++))
done

cat story.txt
